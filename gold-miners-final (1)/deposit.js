import { useState } from 'react'
import { depositOptions, TYME_ACCOUNT } from '../lib/constants'
export default function Deposit({ showToast }){ const [amount, setAmount] = useState(100); const [showAccount, setShowAccount] = useState(false); const [waiting, setWaiting] = useState(null); const onDeposit = () => setShowAccount(true); const onConfirm = async () => { const res = await fetch('/api/deposits', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ amount }) }); if(res.ok){ const entry = await res.json(); setWaiting(entry.id); setShowAccount(false); showToast('Deposit created and pending admin approval'); } else { showToast('Failed to create deposit'); } } return (<div className="max-w-2xl mx-auto"><h2 className="text-2xl font-bold mb-4">Deposit</h2><div className="bg-white p-4 rounded shadow"><label className="block mb-2 font-semibold">Choose deposit amount (Rand)</label><select value={amount} onChange={(e)=>setAmount(Number(e.target.value))} className="w-full p-2 border rounded mb-4">{depositOptions.map(amt=> <option key={amt} value={amt}>R{amt.toLocaleString()}</option>)}</select><div className="flex gap-3"><button onClick={onDeposit} className="px-4 py-2 bg-amber-700 text-white rounded">Deposit</button></div>{showAccount && (<div className="mt-4 p-3 bg-amber-50 rounded"><p className="font-semibold">Please transfer to the following Tyme Bank account:</p><p className="mt-2 text-lg font-bold">Account number: <span className="text-amber-700">{TYME_ACCOUNT}</span></p><p className="text-sm opacity-80 mt-2">After transferring, click "I have deposited". Your deposit will appear as pending and show "Waiting for admin approval" in the Investments list.</p><div className="mt-3"><button onClick={onConfirm} className="px-4 py-2 bg-amber-700 text-white rounded">I have deposited</button></div></div>)}{waiting && (<div className="mt-4 p-3 bg-yellow-100 rounded"><p className="font-bold">Waiting for admin approval</p><p className="text-sm opacity-80 mt-2">Your deposit of R{amount.toLocaleString()} is pending review by an admin. Once approved it will reflect in your investment balance.</p></div>)}</div></div>) }
